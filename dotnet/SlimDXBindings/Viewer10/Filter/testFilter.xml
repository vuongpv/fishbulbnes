<?xml version="1.0" encoding="utf-8" ?>
<FilterChain>
	<Resources>
		<Resource Name="NesOutput" Source="nes:output" />
		<Resource Name="NesPalette" Source="nes:palette" />
		<Resource Name="Background" Source="file:mario.jpg" />
		<Resource Name="Noise" Source="sys:noise:128" />
	</Resources>
	<Variables>
		<Variable Name="Timer" Type="Float" Source="nes:framecount" />
	</Variables>

	<Filters>
	<Filter Name="tiles" Height="256" Width="256" Effect="RenderNesSprites" Technique="RenderTiles" >
		<Inputs>
			<Input Type="FilterOutput" Filter="NesOutput" EffectVariable="texture2d"/>
			<Input Type="FilterOutput" Filter="NesPalette" EffectVariable="nesPal" />
		</Inputs>
	</Filter>

	<Filter Name="tileMask" Height="256" Width="256" Effect="RenderNesSprites" Technique="RenderTileMask" >
		<Inputs>
			<Input Type="FilterOutput" Filter="NesOutput" EffectVariable="texture2d"/>
			<Input Type="FilterOutput" Filter="NesPalette" EffectVariable="nesPal" />
		</Inputs>
	</Filter>

	<Filter Name="sprites" Height="256" Width="256" Effect="RenderNesSprites" Technique="RenderSprites" >
		<Inputs>
			<Input Type="FilterOutput" Filter="NesOutput" EffectVariable="texture2d"/>
			<Input Type="FilterOutput" Filter="NesPalette" EffectVariable="nesPal" />
		</Inputs>
	</Filter>

	<Filter Name="spriteMask" Height="256" Width="256" Effect="RenderNesSprites" Technique="RenderSpriteMask" >
		<Inputs>
			<Input Type="FilterOutput" Filter="NesOutput" EffectVariable="texture2d" />
			<Input Type="FilterOutput" Filter="NesPalette" EffectVariable="nesPal" />
		</Inputs>
	</Filter>

	<Filter Name="wavyTiles" Height="512" Width="512" Effect="blue" Technique="Wave" >
		<Inputs>
			<Input Type="FilterOutput" Filter="tiles" EffectVariable="texture2d" />
			<Input Type="Resource" ResourceName="Noise" EffectVariable="noiseTex" />
			<Input Type="Scalar" EffectVariable="timer" Source="Timer"/>
		</Inputs>
	</Filter>

	<Filter Name="wavyTileMask" Height="512" Width="512" Effect="blue" Technique="Wave" >
		<Inputs>
			<Input Type="FilterOutput" Filter="tileMask" EffectVariable="texture2d" />
			<Input Type="Resource" ResourceName="Noise" EffectVariable="noiseTex" />
			<Input Type="Scalar" EffectVariable="timer" Source="Timer"/>
		</Inputs>
	</Filter>

	<Filter Name="combined" Height="1024" Width="1024" Effect="CombineNesOutput" Technique="Render">
		<Inputs>
			<Input Type="FilterOutput" Filter="wavyTiles" EffectVariable="screenOne" />
			<Input Type="FilterOutput" Filter="sprites" EffectVariable="screenTwo" />
			<Input Type="FilterOutput" Filter="spriteMask" EffectVariable="spriteMask" />
			<Input Type="FilterOutput" Filter="wavyTileMask" EffectVariable="tileMask" />
		</Inputs>
	</Filter>


	</Filters>


</FilterChain>